#!/usr/bin/env python3

import re
import string
import requests
from itertools import product

url = "https://insecurity:LTjdgKjKSiHswkf0iOEl@base65536.ctf.insecurity-insa.fr"

r = requests.post(url, data = {'sample':"".join(list(map("".join, product(string.printable,repeat=2))))})
sample = re.search(r'Your encrypted sample is (.*?) and the flag is', r.text).group(1)
flag = re.search(r'and the flag is (.*?) !', r.text,flags=re.DOTALL).group(1)
d = {k : v for (v,k) in zip(list(map("".join, product(string.printable,repeat=2))),sample)}
if "INSA{" in "".join([d[k] for k in flag]):
    exit(0)
else:
    print("".join([d[k] for k in flag]))
    exit(1)
