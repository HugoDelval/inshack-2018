import requests
from itertools import product
import string
import re
def exploitable():
    r = requests.post('http://localhost:5000', data = {'sample':"".join(list(map("".join, product(string.printable,repeat=2))))})
    sample = re.search(r'Your encrypted sample is (.*?) and the flag is', r.text).group(1)
    flag = re.search(r'and the flag is (.*?) !', r.text,flags=re.DOTALL).group(1)
    d = {k : v for (v,k) in zip(list(map("".join, product(string.printable,repeat=2))),sample)}
    if "INSA{" in "".join([d[k] for k in flag]):
        return True
    else:
        print("".join([d[k] for k in flag]))
        return False

exploitable()
